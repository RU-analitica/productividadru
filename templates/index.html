{% extends 'base.html' %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block content %}
    <section class="main">
        <div class="main-input">
            <div class="main-input--header">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Red unica logo" class="logo" />
                <h2>¡Bienvenido al módulo de mensajes de desempeño!</h2>
            </div>
            <div class="main-input--body">
                {{ wtf.quick_form(login_form) }}
                <form class="d-flex">
                    <input id="form" name="formid" class="form-control me-2" type="search" placeholder="Digite su ID" aria-label="Search" />
                </form>
                <button id="button" name="button" type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exampleModal">
                    Solicitar mensajes
                  </button>
            </div>
        </div>
    </section>

    <script>
        async function getData() {
            try{
                const req = await fetch("/id", {
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    method: 'POST',
                    mode: 'cors',
                    body: JSON.stringify({
                        formid: document.getElementById('form').value
                    })
                })
                const data = await req
                results = document.getElementById('messages')
                results.innerHTML = `${await data.text()}`
            }
            catch(err){
                console.log(err)
            }
        }
        const button = document.getElementById('button')
        button.addEventListener('click', getData)
    </script>
{% endblock %}